/*! For license information please see main.92ea7eb5efdd4affa62e.js.LICENSE.txt */
(function(){"use strict";var __webpack_modules__={349:function(t,e,r){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}r.d(e,{m:function(){return l}});var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(u,t);var e,r,n,c=a(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).parser=e.parser,r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(r(310).w)},310:function(t,e,r){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}r.d(e,{w:function(){return s}});var s=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(l,t);var e,r,n,c=a(l);function l(t,e){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),r=c.call(this,t,e),n=u(r),i=[],(o="unsubscribers")in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,r.emitter=e.emitter,r.wredux=e.wredux,r.strSubs=e.subscribe,r.componentWillMount(),r}return e=l,(r=[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"componentWilUnmount",value:function(){}},{key:"emit",value:function(t,e){this.emitter.emit(t,e)}},{key:"on",value:function(t,e){var r=this.emitter.subscribe(t,e);this.unsubscribers.push(r)}},{key:"dispatch",value:function(t){this.wredux.dispatch(t)}},{key:"getState",value:function(){return this.wredux.getState()}},{key:"wreduxChanged",value:function(t){console.warn("WRedux: dispatch method in Component",t,this)}},{key:"init",value:function(){this.initDOMListeners()}},{key:"destroy",value:function(){this.removeDOMListeners(),this.unsubscribers.forEach((function(t){return t()}))}},{key:"setComponentState",value:function(t){throw new Error("Use decorator @stateComponent")}},{key:"getComponentState",value:function(){throw new Error("Use decorator @stateComponent")}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}(r(868).P)},868:function(t,e,r){r.d(e,{P:function(){return i}});var n=r(958);function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(){function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=r,!e)throw new Error("No $root privided for DomListener");this.$root=e}var e,r,i;return e=t,(r=[{key:"initDOMListeners",value:function(){var t=this;this.options.listeners.forEach((function(e){var r=n.d.createDOMListenerMethodName(e);if(!t[r])throw new Error("Method ".concat(r," is not inplemented in ").concat(t.options.name," Component"));t[r]=t[r].bind(t),t.$root.on(e,t[r])}))}},{key:"removeDOMListeners",value:function(){var t=this;this.options.listeners.forEach((function(e){t.$root.off(e)}))}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}()},801:function(t,e,r){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o;r.d(e,{Q:function(){return i},V:function(){return o}}),function(t){t.FORMULA_INPUT="formula:input",t.TABLE_CELECT_CELL="table:select-cell",t.TABLE_INPUT="table:input",t.FORMULA_TAB_OR_ENTER_PRESS="formula:tab-or-enter-press",t.FORMULA_SELECT_ALL="formula:select-all",t.TABLE_EMIT_INFO="table:emit-info",t.TOOLBAR_BUTTON_CLICK="toolbar:button-click",t.PARSER_CHECK_CELL="parser:check-cell",t.TABLE_PARSER_ID="table:parser-id",t.FORMULA_PRINT_FORMULA_SELECT="formula:print-formula-select",t.PARSER_CLEAR_FORMULA_SELECT="parser:clear-formula-select"}(o||(o={}));var i=function(){function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n={},(r="subscribers")in(e=this)?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n}var e,r,o;return e=t,(r=[{key:"emit",value:function(t,e){Array.isArray(this.subscribers[t])&&this.subscribers[t].forEach((function(t){return t(e)}))}},{key:"subscribe",value:function(t,e){var r=this;return this.subscribers[t]=this.subscribers[t]||[],this.subscribers[t].push(e),function(){r.subscribers[t]=r.subscribers[t].filter((function(t){return t!==e}))}}}])&&n(e.prototype,r),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}()},273:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{_:function(){return Parser}});var _redux__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(785),_Emitter__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(801);function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],a=!0,c=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Parser=function(){function Parser(t,e){var r=this;_classCallCheck(this,Parser),_defineProperty(this,"firstSymbol","="),_defineProperty(this,"cellsData",{}),this.wredux=t,this.emitter=e,this.emitter.subscribe(_Emitter__WEBPACK_IMPORTED_MODULE_1__.V.TABLE_PARSER_ID,(function(t){if("string"==typeof t){var e=_slicedToArray(t.split("|"),2),n=e[0],o=e[1];r.cellsData[n]=o}}))}return _createClass(Parser,[{key:"checkCells",value:function(t){var e=t.replace(/\s/g,"");if(!e.startsWith(this.firstSymbol))return[];var r=e.slice(1).split(/[+-/*/(/)]/).filter((function(t){return""!==t})),n=[];return r.forEach((function(t){if(isNaN(Number(t))){var e=t.toUpperCase();n.push(e)}})),n}},{key:"parse",value:function parse(string,type,cellId){var _this2=this,str=string.replace(/\s/g,"");if(!str.startsWith(this.firstSymbol))return cellId&&this.wredux.dispatch((0,_redux__WEBPACK_IMPORTED_MODULE_0__.JP)(cellId,str,str)),string;var strFormula=str.slice(1),res,arr=strFormula.split(/[+-/*/(/)]/).filter((function(t){return""!==t})),err=!1;if(arr.forEach((function(t){if(isNaN(Number(t))){var e=t.toUpperCase();if(_this2.emitter.emit(_Emitter__WEBPACK_IMPORTED_MODULE_1__.V.PARSER_CHECK_CELL,e),_this2.cellsData[e])return void(strFormula=strFormula.replace(t,_this2.cellsData[e]));err=!0}})),err)return cellId&&this.wredux.dispatch((0,_redux__WEBPACK_IMPORTED_MODULE_0__.JP)(cellId,string,string)),this.emitter.emit(_Emitter__WEBPACK_IMPORTED_MODULE_1__.V.PARSER_CLEAR_FORMULA_SELECT),string;try{res=eval(strFormula)}catch(t){return cellId&&this.wredux.dispatch((0,_redux__WEBPACK_IMPORTED_MODULE_0__.JP)(cellId,string,string)),string}return cellId&&this.wredux.dispatch((0,_redux__WEBPACK_IMPORTED_MODULE_0__.JP)(cellId,str,"".concat(res||""))),"input"===type?str:"output"===type?"".concat(res||""):string}}]),Parser}()},879:function(t,e,r){r.d(e,{Fd:function(){return c},JP:function(){return s},N:function(){return h},No:function(){return a},QB:function(){return o},VB:function(){return i},Wt:function(){return u},i2:function(){return y},je:function(){return l},ku:function(){return f},lh:function(){return d},rO:function(){return b},z:function(){return p}});var n=r(629),o=function(){return{type:n.H.INIT,payload:null}},i=function(t){return{type:n.H.TABLE_RESIZE,payload:t}},a=function(t,e){return{type:n.H.CHANGE_TEXT,payload:{id:t,string:e}}},c=function(t,e){return{type:n.H.CHANGE_STYLE,payload:{id:t,style:e}}},u=function(t){return{type:n.H.STYLES_CURRENT_CELL,payload:{styles:t}}},l=function(t){return{type:n.H.CHANGE_TITLE,payload:t}},s=function(t,e,r){return{type:n.H.CHANGE_PARSER_DATA,payload:{id:t,formula:e,result:r}}},f=function(){return{type:n.H.CHANGE_OPEN_DATE}},p=function(t){return{type:n.H.CREATE_TABLE,payload:t}},y=function(t,e){return{type:n.H.CREATE_TABLE_PRESET,payload:{id:t,excel:e}}},b=function(t){return{type:n.H.SET_CURRENT_EXCEL_STATE,payload:t}},d=function(t){return{type:n.H.SAVE_CURRENT_EXCEL_STATE,payload:t}},h=function(t){return{type:n.H.REMOVE_CURRENT_EXCEL_STATE,payload:t}}},785:function(t,e,r){r.d(e,{fP:function(){return i},ku:function(){return n.ku},JP:function(){return n.JP},Fd:function(){return n.Fd},No:function(){return n.No},je:function(){return n.je},rE:function(){return f},aY:function(){return p},N:function(){return n.N},VB:function(){return n.VB},QW:function(){return E},lh:function(){return n.lh},rO:function(){return n.rO},Wt:function(){return n.Wt}});var n=r(879);function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(){function t(e,r){var o,i,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a=[],(i="subscribers")in(o=this)?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,this.rootReducer=e,this.state=e(r,(0,n.QB)())}var e,r,i;return e=t,(r=[{key:"subscribe",value:function(t){var e=this;return this.subscribers.push(t),{unsubscribe:function(){e.subscribers=e.subscribers.filter((function(e){return e!==t}))},unsubscribeAll:function(){e.subscribers=[]}}}},{key:"dispatch",value:function(t){var e=this;this.state=this.rootReducer(this.state,t),this.subscribers.forEach((function(t){return t(e.state)}))}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this.state))}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}(),a=r(629),c=r(958);function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s={id:0,resizeState:{col:{},row:{}},cellsDataState:{},cellsStylesState:{},currentText:"",currentCellStyles:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},a.an),title:"Новая таблица",parserData:{},openDate:(new Date).toJSON()},f={excelState:s,dashboardState:{current:0,excels:[]}};function p(t){return c.t.get(t)?c.t.get(t):f}function y(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach((function(e){v(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t,e){var r=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(s));switch(e.type){case a.H.INIT:return h({},t);case a.H.CREATE_TABLE:return n.id=e.payload,h(h({},r),{},{current:e.payload,excels:[].concat(y(r.excels),[n])});case a.H.CREATE_TABLE_PRESET:var o=e.payload,i=o.id,c=o.excel,u=JSON.parse(JSON.stringify(c));return u.id=i,h(h({},r),{},{current:i,excels:[].concat(y(r.excels),[u])});case a.H.SAVE_CURRENT_EXCEL_STATE:var l=e.payload.id,f=r.excels.filter((function(t){return t.id!==l}));return h(h({},r),{},{excels:[e.payload].concat(y(f))});case a.H.REMOVE_CURRENT_EXCEL_STATE:var p=r.excels.filter((function(t){return t.id!==e.payload}));return h(h({},r),{},{excels:y(p)});default:return h({},t)}}function O(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?O(Object(r),!0).forEach((function(e){w(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function w(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g(t,e){var r=JSON.parse(JSON.stringify(t));switch(e.type){case a.H.INIT:return _({},r);case a.H.TABLE_RESIZE:var n=e.payload,o=n.type,i=n.id,c=n.value;return _(_({},r),{},{resizeState:w({col:_({},r.resizeState.col),row:_({},r.resizeState.row)},o,_(_({},r.resizeState[o]),{},w({},i,c)))});case a.H.CHANGE_TEXT:var u=e.payload,l=u.string,s=u.id;return _(_({},r),{},{currentText:l,cellsDataState:_(_({},r.cellsDataState),{},w({},s,l))});case a.H.CHANGE_TITLE:return _(_({},r),{},{title:e.payload});case a.H.CHANGE_OPEN_DATE:return _(_({},r),{},{openDate:(new Date).toJSON()});case a.H.CHANGE_PARSER_DATA:var f=e.payload,p=f.id,y=f.result,b=f.formula;return _(_({},r),{},{parserData:_(_({},r.parserData),{},w({},p,{result:y,formula:b}))});case a.H.CHANGE_STYLE:var d=e.payload,h=d.id,v=d.style;return Object.keys(v).forEach((function(t){r.currentCellStyles[t]=v[t]})),_(_({},r),{},{cellsStylesState:_(_({},r.cellsStylesState),{},w({},h,_(_({},r.cellsStylesState[h]),v)))});case a.H.STYLES_CURRENT_CELL:var m=e.payload.styles;return Object.keys(m).forEach((function(t){r.currentCellStyles[t]=m[t]})),_({},r);case a.H.SET_CURRENT_EXCEL_STATE:return _({},JSON.parse(JSON.stringify(e.payload)));default:return _({},r)}}function E(t,e){return{excelState:g(t.excelState,e),dashboardState:m(t.dashboardState,e)}}},629:function(t,e,r){r.d(e,{wC:function(){return y},H:function(){return n},aU:function(){return h},DM:function(){return b},fw:function(){return u},$7:function(){return c},nv:function(){return W},xT:function(){return p},z0:function(){return l},uh:function(){return v},PA:function(){return i},ii:function(){return o},O7:function(){return a},Nq:function(){return H},Wb:function(){return s},un:function(){return f},VU:function(){return d},dP:function(){return U},T$:function(){return w},an:function(){return _},tA:function(){return m},_O:function(){return O}});var n,o=20,i=30,a=2,c=110,u=24,l="1:1",s="selected",f="selected",p="formula-select",y="active",b=["rgb(50, 50, 50)","white","red","yellow","orange","rgb(37, 95, 212)","rgb(100, 50, 255, 0.1)"],d="excel",h={A:65,Z:90},v=25,m={id:0,resizeState:{col:{10:76},row:{7:24,14:22}},cellsDataState:{"1:1":"","4:9":"Tesla","4:12":"","4:5":"Акция","5:5":"Цена_$","6:5":"Количество","6:6":"","7:5":"Сумма_Р","7:9":"=E9*F9*J3","4:7":"Apple","4:8":"Mircosoft","5:7":"140","8:5":"","6:8":"10","7:8":"=E8*F8*J3","7:7":"=E7*F7*J3","9:5":"","9:3":"Доллар:","10:3":"57","10:7":"","9:8":"","9:7":"","9:9":"","8:7":"","6:7":"20","8:11":"","5:8":"265","5:11":"","5:14":"","1:8":"","4:11":"","5:12":"","7:11":"=G7+G8+G9","6:13":"","6:14":"","6:1":"","7:13":"","6:11":"Сумма","5:1":"","5:9":"760","6:9":"3","6:12":""},cellsStylesState:{"4:5":{border:"1px solid black",justifyContent:"center",fontWeight:"bold"},"5:5":{border:"1px solid black",justifyContent:"center",fontWeight:"bold"},"6:5":{border:"1px solid black",justifyContent:"center",fontWeight:"bold"},"7:5":{border:"1px solid black",justifyContent:"center",fontWeight:"bold"},"9:3":{justifyContent:"flex-end",fontWeight:"bold"},"10:3":{justifyContent:"center",fontStyle:"italic",border:"1px solid black","background-color":"rgb(100, 50, 255, 0.1)"},"4:7":{justifyContent:"center","background-color":"rgb(100, 50, 255, 0.1)",fontWeight:"bold"},"5:7":{justifyContent:"center","background-color":"rgb(100, 50, 255, 0.1)"},"6:7":{justifyContent:"center","background-color":"rgb(100, 50, 255, 0.1)",color:"rgb(50, 50, 50)",fontWeight:"bold"},"7:7":{justifyContent:"center","background-color":"rgb(100, 50, 255, 0.1)"},"4:8":{justifyContent:"center","background-color":"rgb(100, 50, 255, 0.1)",fontWeight:"bold"},"5:8":{justifyContent:"center","background-color":"rgb(100, 50, 255, 0.1)"},"6:8":{justifyContent:"center","background-color":"rgb(100, 50, 255, 0.1)",fontWeight:"bold"},"7:8":{justifyContent:"center","background-color":"rgb(100, 50, 255, 0.1)"},"4:9":{"background-color":"rgb(100, 50, 255, 0.1)",justifyContent:"center",fontWeight:"bold"},"5:9":{"background-color":"rgb(100, 50, 255, 0.1)",justifyContent:"center"},"6:9":{"background-color":"rgb(100, 50, 255, 0.1)",justifyContent:"center",fontWeight:"bold"},"7:9":{"background-color":"rgb(100, 50, 255, 0.1)",justifyContent:"center"},"3:9":{justifyContent:"center"},"6:11":{justifyContent:"flex-end",fontWeight:"bold"},"7:11":{border:"1px solid black",justifyContent:"center",fontWeight:"normal"},"3:14":{justifyContent:"center"}},currentText:"=E9*F9*J3",currentCellStyles:{justifyContent:"center",alignItems:"flex-start",fontWeight:"normal",textDecoration:"none",fontStyle:"normal",borderColor:"rgb(222, 222, 222)",color:"rgb(50, 50, 50)",backgroundColor:"rgba(100, 50, 255, 0.1)",openColorModal:!1,openBackgroundColorModal:!1,dataType:"default",countZeros:2,border:"1px solid black","background-color":"rgb(100, 50, 255, 0.1)"},title:"Инвестиции",parserData:{"4:5":{result:"Акция",formula:"Акция"},"5:5":{result:"Цена_$",formula:"Цена_$"},"6:5":{result:"Количество",formula:"Количество"},"7:5":{result:"Сумма_Р",formula:"Сумма_Р"},"4:7":{result:"Apple",formula:"Apple"},"8:5":{result:"",formula:""},"9:3":{result:"Доллар:",formula:"Доллар:"},"10:3":{result:"57",formula:"57"},"5:7":{result:"140",formula:"140"},"6:7":{result:"20",formula:"20"},"7:7":{result:"159600",formula:"=E7*F7*J3"},"4:8":{result:"Mircosoft",formula:"Mircosoft"},"5:8":{result:"265",formula:"265"},"6:8":{result:"10",formula:"10"},"7:8":{result:"151050",formula:"=E8*F8*J3"},"7:9":{result:"129960",formula:"=E9*F9*J3"},"4:9":{result:"Tesla",formula:"Tesla"},"5:9":{result:"760",formula:"760"},"6:9":{result:"3",formula:"3"},"6:11":{result:"Сумма",formula:"Сумма"},"7:11":{result:"440610",formula:"=G7+G8+G9"},"3:14":{result:"",formula:""}},openDate:"2022-07-08T14:37:03.510Z"};!function(t){t.INIT="__INIT__",t.TABLE_RESIZE="TABLE_RESIZE",t.CHANGE_TEXT="CHANGE_TEXT",t.CHANGE_TITLE="CHANGE_TITLE",t.CHANGE_STYLE="CHANGE_STYLE",t.STYLES_CURRENT_CELL="STYLES_CURRENT_CELL",t.CHANGE_PARSER_DATA="CHANGE_PARSER_DATA",t.CHANGE_OPEN_DATE="CHANGE_OPEN_DATE",t.CREATE_TABLE="CREATE_TABLE",t.CREATE_TABLE_PRESET="CREATE_TABLE_PRESET",t.SET_CURRENT_EXCEL_STATE="SET_CURRENT_EXCEL_STATE",t.SAVE_CURRENT_EXCEL_STATE="SAVE_CURRENT_EXCEL_STATE",t.REMOVE_CURRENT_EXCEL_STATE="REMOVE_CURRENT_EXCEL_STATE"}(n||(n={}));var O=["justifyContent","alignItems","fontWeight","textDecoration","fontStyle","borderColor","color","backgroundColor"],_={justifyContent:"flex-start",alignItems:"flex-start",fontWeight:"normal",textDecoration:"none",fontStyle:"none",borderColor:"string",color:"string",backgroundColor:"none",openColorModal:!1,openBackgroundColorModal:!1,dataType:"default",countZeros:2},w={justifyContent:"flex-start",alignItems:"flex-start",fontWeight:"normal",textDecoration:"none",fontStyle:"normal",borderColor:"rgb(222, 222, 222)",color:"rgb(50, 50, 50)",backgroundColor:"none"};function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function E(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function j(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function S(t,e){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},S(t,e)}function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=T(t);if(e){var o=T(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return C(this,r)}}function C(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function k(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}(i,t);var e,r,n,o=P(i);function i(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?E(Object(r),!0).forEach((function(e){k(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"IComponent",listeners:[]},e))}return e=i,(r=[{key:"toHTML",value:function(){return""}}])&&j(e.prototype,r),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(r(310).w);function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function R(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function D(t,e){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},D(t,e)}function N(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=I(t);if(e){var o=I(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return M(this,r)}}function M(t,e){if(e&&("object"===A(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}function $(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}k(x,"classNames",["",""]);var H,W,B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D(t,e)}(i,t);var e,r,n,o=N(i);function i(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?R(Object(r),!0).forEach((function(e){$(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"IComponent",listeners:[]},e))}return e=i,(r=[{key:"toHTML",value:function(){return""}}])&&L(e.prototype,r),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(r(349).m);$(B,"classNames",["",""]),function(t){t.COL="col",t.ROW="row"}(H||(H={})),function(t){t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown",t.ARROW_RIGHT="ArrowRight",t.ARROW_LEFT="ArrowLeft",t.ENTER="Enter",t.TAB="Tab"}(W||(W={}));var U=[W.ARROW_UP,W.ARROW_DOWN,W.ARROW_LEFT,W.ARROW_RIGHT,W.ENTER,W.TAB]},958:function(t,e,r){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,c=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{t:function(){return f},d:function(){return l}});var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"methodPrefix","on"),c(this,"WAxiosMethodPrefix","add")}var e,r,i;return e=t,r=[{key:"createDOMListenerMethodName",value:function(t){return this.methodPrefix+this.capitalize(t)}},{key:"createWAxiosBuilderMethodName",value:function(t){return this.WAxiosMethodPrefix+this.capitalize(t)}},{key:"capitalize",value:function(t){return t[0].toLocaleUpperCase()+t.slice(1)}},{key:"parseCellId",value:function(t){var e=o(t.split(":").map((function(t){return+t})),2);return{col:e[0],row:e[1]}}},{key:"parseStyleValueToInt",value:function(t){return t.endsWith("px")?+t.slice(0,-2):+t}},{key:"isEqual",value:function(t,e){return"object"===n(t)&&"object"===n(t)?JSON.stringify(t)===JSON.stringify(e):t===e}},{key:"camelCaseToDashCase",value:function(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t[0].toLowerCase())}))}},{key:"debounse",value:function(t,e){var r;return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];var a=function(){clearTimeout(r),t.apply(void 0,o)};clearTimeout(r),r=setTimeout(a,e)}}}],r&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}(),l=new u;function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var f=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"get",value:function(t){var e=localStorage.getItem(t);return e?JSON.parse(e):null}},{key:"set",value:function(t,e){localStorage.setItem(t,JSON.stringify(e))}},{key:"key",value:function(t){return localStorage.key(t)}},{key:"length",get:function(){return localStorage.length}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}())}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=function(t,e){for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var __webpack_exports__={};!function(){__webpack_require__(868);var t=__webpack_require__(801),e=__webpack_require__(785),r=__webpack_require__(958);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=function(){function t(r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"unsabs",[]),i(this,"prevState",function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e.rE)),this.wredux=r}var a,c,u;return a=t,(c=[{key:"subscribeComponents",value:function(t){var e=this;this.prevState=this.wredux.getState();var n=this.wredux.subscribe((function(n){Object.keys(n).forEach((function(o){r.d.isEqual(e.prevState[o],n[o])||t.forEach((function(t){if(t.strSubs&&t.strSubs.state===o){if(-1===t.strSubs.value.findIndex((function(t){return!r.d.isEqual(e.prevState[o][t],n[o][t])})))return;var a=i({},o,n[o]);t.wreduxChanged(a)}}))})),e.prevState=e.wredux.getState()}));this.unsabs.push(n)}},{key:"unsubscribeComponents",value:function(){this.unsabs.forEach((function(t){return t.unsubscribe()}))}}])&&o(a.prototype,c),u&&o(a,u),Object.defineProperty(a,"prototype",{writable:!1}),t}(),c=__webpack_require__(273),u=__webpack_require__(629);function l(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=function(){function t(e){var r,n,o;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o={},(n="listeners")in(r=this)?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,"string"!=typeof e)this.$nativeElement=e;else{var i=document.querySelector(e);if(!i)throw new Error("WQuery: Node is not defined, Element is not found. Selector: ".concat(e));this.$nativeElement=i}}var e,r,n;return e=t,r=[{key:"setHtml",value:function(t){return this.$nativeElement.innerHTML=t,this}},{key:"getHtml",value:function(){return this.$nativeElement.outerHTML.trim()}},{key:"append",value:function(e){return e instanceof t?(this.$nativeElement.append(e.$nativeElement),this):(this.$nativeElement.append(e),this)}},{key:"on",value:function(t,e){this.listeners[t]=e,this.$nativeElement.addEventListener(t,e)}},{key:"off",value:function(t){this.$nativeElement.removeEventListener(t,this.listeners[t])}},{key:"nativeElement",get:function(){return this.$nativeElement}},{key:"getParent",value:function(t){if(t){var e=this.$nativeElement.closest(t);return e?y(e):null}var r=this.$nativeElement.parentNode;return r?y(r):null}},{key:"coords",get:function(){return this.$nativeElement.getBoundingClientRect()}},{key:"css",value:function(t){var e=this;return Object.keys(t).forEach((function(r){var n=t[r];e.$nativeElement.style[r]=n})),this}},{key:"getStyles",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u._O;return e.reduce((function(e,r){return e[r]=t.$nativeElement.style[r],e}),{})}},{key:"addClass",value:function(t){return this.$nativeElement.classList.add(t),this}},{key:"removeClass",value:function(t){return this.$nativeElement.classList.remove(t),this}},{key:"clear",value:function(){return this.setHtml(""),this}},{key:"focus",value:function(){return this.$nativeElement.focus(),this}},{key:"data",get:function(){return this.$nativeElement.dataset}},{key:"setAttr",value:function(t,e){return this.$nativeElement.setAttribute(t,e),this}},{key:"getAttr",value:function(t){return this.$nativeElement.getAttribute(t)}},{key:"find",value:function(t){var e=this.$nativeElement.querySelector(t);return null===e?null:y(e)}},{key:"findAll",value:function(t){var e=this.$nativeElement.querySelectorAll(t),r=[];return e.forEach((function(t){return r.push(y(t))})),r}},{key:"textContent",get:function(){return(this.$nativeElement.textContent||"").trim()}},{key:"setTextContent",value:function(t){var e=this,r=l(this.$nativeElement.children);return this.$nativeElement.textContent=t,r.forEach((function(t){return e.$nativeElement.append(t)})),this}}],r&&f(e.prototype,r),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t){return new p(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}y.create=function(t,e){var r=document.createElement(t);if(e){if(Array.isArray(e))return e.forEach((function(t){return r.classList.add(t)})),y(r);r.classList.add(e)}return y(r)};var d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"path",get:function(){return window.location.hash.slice(1)}},{key:"pathName",get:function(){return this.path.split("/").shift()||""}},{key:"params",get:function(){var t=this.path.split("/");return t.shift(),t}},{key:"firstParam",get:function(){return this.params[0]}},{key:"navigation",value:function(t){window.location.hash=t}}],(r=null)&&b(e.prototype,r),n&&b(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var v=function(){function t(e,r){var n,o,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i=null,(o="page")in(n=this)?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,this.routes=r,this.$root=y(e),this.changePage=this.changePage.bind(this),this.init()}var e,r,n;return e=t,r=[{key:"changePage",value:function(){this.page&&this.page.destroyPage(),this.$root.clear();var t=d.pathName;this.routes[t]?this.createPage(t):this.createPage("/")}},{key:"createPage",value:function(t){var e=this.routes[t],r=e.Page,n=e.options;this.page=new r(n),this.$root.append(this.page.getRoot()),this.page.initPage()}},{key:"init",value:function(){window.addEventListener("hashchange",this.changePage),this.changePage()}},{key:"destroy",value:function(){window.removeEventListener("hashchange",this.changePage)}}],r&&h(e.prototype,r),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function O(t,e,r){return e&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var _=O((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e})),w=__webpack_require__(310);function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function E(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function j(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?E(Object(r),!0).forEach((function(e){R(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=A(t);if(e){var o=A(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return k(this,r)}}function k(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return x(t)}function x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}function R(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L(t){return function(e){return function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(a,e);var r,n,o,i=T(a);function a(){var e;S(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return R(x(e=i.call.apply(i,[this].concat(n))),"state",t),e}return r=a,(n=[{key:"setComponentState",value:function(t){this.state=j({},t),this.$root.setHtml(this.toHTML())}},{key:"getComponentState",value:function(){return j({},this.state)}}])&&P(r.prototype,n),o&&P(r,o),Object.defineProperty(r,"prototype",{writable:!1}),a}(e)}}function D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var N=function(){function n(o,i){var c,l,s,f=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),s={},(l="routes")in(c=this)?Object.defineProperty(c,l,{value:s,enumerable:!0,configurable:!0,writable:!0}):c[l]=s,this.selector=o,this.wredux=new e.fP(e.QW,(0,e.aY)(u.VU));var p=r.d.debounse((function(t){r.t.set(u.VU,t)}),400);this.wredux.subscribe(p),this.wreduxSubscriber=new a(this.wredux),this.emitter=new t.Q,i.forEach((function(t){var e=t.path,r=t.Page;f.routes[e]={Page:r,options:{wredux:f.wredux,wreduxSubscriber:f.wreduxSubscriber,emitter:f.emitter}}}))}var o,i,c;return o=n,(i=[{key:"render",value:function(){new v("#root",this.routes)}}])&&D(o.prototype,i),c&&D(o,c),Object.defineProperty(o,"prototype",{writable:!1}),n}(),M=__webpack_require__(349);function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $=function(){function t(e){var r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o=[],(n="instantComponents")in(r=this)?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,this.components=e.components,this.wredux=e.wredux,this.wreduxSubscriber=e.wreduxSubscriber,this.emitter=e.emitter,this.parser=new c._(this.wredux,this.emitter)}var r,n,o;return r=t,n=[{key:"setExcelStateFromId",value:function(){var t=this.wredux.getState().dashboardState,r=d.firstParam,n=t.excels.find((function(t){return t.id===+r}));n?this.wredux.dispatch((0,e.rO)(n)):d.navigation("")}},{key:"saveExcelStateFromId",value:function(){var t=this.wredux.getState().excelState;this.wredux.dispatch((0,e.lh)(t))}},{key:"getRootExcel",value:function(){this.setExcelStateFromId();var t=y.create("div","excel"),e={emitter:this.emitter,wredux:this.wredux,parser:this.parser};return this.instantComponents=this.components.map((function(r){var n=y.create("div",r.classNames),o=new r(n,e);return n.setHtml(o.toHTML()),t.append(n),o})),t}},{key:"init",value:function(){this.wreduxSubscriber.subscribeComponents(this.instantComponents),this.instantComponents.forEach((function(t){t.init(),t.componentDidMount()}))}},{key:"destroy",value:function(){this.saveExcelStateFromId(),this.instantComponents.forEach((function(t){t.componentWilUnmount(),t.destroy()})),this.wreduxSubscriber.unsubscribeComponents()}}],n&&I(r.prototype,n),o&&I(r,o),Object.defineProperty(r,"prototype",{writable:!1}),t}();function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function W(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}function F(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=J(t);if(e){var o=J(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return V(this,r)}}function V(t,e){if(e&&("object"===H(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return G(t)}function G(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function J(t){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},J(t)}function q(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var z,K,X=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(a,e);var r,n,o,i=F(a);function a(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),r=i.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?W(Object(r),!0).forEach((function(e){q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Formula",listeners:["input","keydown","mousedown"],subscribe:{state:"excelState",value:["currentText"]}},e)),q(G(r),"$input",y.create("div")),r}return r=a,(n=[{key:"onInput",value:function(){this.emit(t.V.FORMULA_INPUT,this.parser.parse(this.$input.textContent,"input"))}},{key:"onMousedown",value:function(e){e.target instanceof HTMLDivElement&&(this.emit(t.V.FORMULA_PRINT_FORMULA_SELECT),e.target.dataset.current===this.$currentCell.data.current&&(e.preventDefault(),this.emit(t.V.FORMULA_SELECT_ALL)))}},{key:"wreduxChanged",value:function(t){var e=t.excelState.currentText;"string"==typeof e&&this.$input.setTextContent(e)}},{key:"onKeydown",value:function(e){e.key!==u.nv.ENTER&&e.key!==u.nv.TAB||(e.preventDefault(),this.emit(t.V.FORMULA_TAB_OR_ENTER_PRESS))}},{key:"componentDidMount",value:function(){var e=this,r=this.$root.find("[data-input]"),n=this.$root.find("[data-current]");r&&n&&(this.$input=r,this.$currentCell=n,this.on(t.V.TABLE_CELECT_CELL,(function(t){"string"==typeof t&&e.$input.setTextContent(t)})),this.on(t.V.TABLE_EMIT_INFO,(function(t){"string"==typeof t&&e.$currentCell.setTextContent(t)})))}},{key:"toHTML",value:function(){return'\n      <div data-current="true" class="excel-formula__current-cell"></div>\n      <div class="excel-formula__formula-icon">\n        <i class="material-icons">\n          functions\n        </i>\n      </div>\n      <div contenteditable data-input="true" spellcheck="false" class="excel-formula__formula-input"></div>\n    '}}])&&B(r.prototype,n),o&&B(r,o),Object.defineProperty(r,"prototype",{writable:!1}),a}(M.m);function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function tt(t,e){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tt(t,e)}function et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=nt(t);if(e){var o=nt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return rt(this,r)}}function rt(t,e){if(e&&("object"===Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function nt(t){return nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nt(t)}function ot(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}q(X,"classNames",["excel__formula","excel-formula"]);var it=L({openModal:!1})((K=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tt(t,e)}(a,t);var r,n,o,i=et(a);function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(r),!0).forEach((function(e){ot(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Header",listeners:["input","click"]},e))}return r=a,(n=[{key:"componentDidMount",value:function(){this.dispatch((0,e.ku)()),this.setComponentState({openModal:!0})}},{key:"onClick",value:function(t){if(t.target instanceof HTMLElement){var e=y(t.target);e.data.logo&&d.navigation(""),e.data.out&&d.navigation("")}}},{key:"onInput",value:function(t){t.target instanceof HTMLInputElement&&(this.dispatch((0,e.je)(t.target.value)),this.dispatch((0,e.lh)(this.getState().excelState)))}},{key:"toHTML",value:function(){var t=this.getState().excelState.title;return this.getComponentState(),function(t,e){return'\n    <div class="excel-header__left-panel h-left-panel">\n      <div data-logo="true" class="h-left-panel__logo"></div>\n      <div class="h-left-panel__group h-group">\n        <input data-input="true" value="'.concat(e,'" class="h-group__input">\n        <div class="h-group__menubars menubars">\n          <button class="menubars__button">Файл</button>\n          <button class="menubars__button">Правка</button>\n          <button class="menubars__button">Вид</button>\n          <button class="menubars__button">Вставка</button>\n          <button class="menubars__button">Формат</button>\n          <button class="menubars__button">Данные</button>\n          <button class="menubars__button">Инструменты</button>\n          <button class="menubars__button">Расширения</button>\n          <button class="menubars__button">Справка</button>\n        </div>\n      </div>\n    </div>\n    <div class="excel-header__right-panel h-right-panel">\n      <button data-out="true" data-remove="true" class="h-right-panel__button">Выйти</button>\n      <button class="h-right-panel__share-button">\n        <i class="material-icons">\n          add_link\n        </i>\n        Общий доступ</button>\n      <div class="h-right-panel__user-avatar">\n        <i class="material-icons icon">\n          account_circle\n        </i>\n      </div>\n    </div>\n  ')}(0,t)}}])&&Q(r.prototype,n),o&&Q(r,o),Object.defineProperty(r,"prototype",{writable:!1}),a}(M.m),ot(K,"classNames",["excel__header","excel-header"]),z=K))||z;function at(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ct(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?at(Object(r),!0).forEach((function(e){ut(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ut(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lt(t,e){return function(n){var o=n.letter,i=n.index,a=n.width,c="".concat(i,":").concat(t),l=e.cellsDataState[c];e.parserData[c]&&(l=e.parserData[c].result);var s=ct({},u.T$),f=e.cellsStylesState["".concat(i,":").concat(t)];f&&(s=ct(ct({},s),f));var p=Object.keys(s).map((function(t){return"".concat(r.d.camelCaseToDashCase(t),": ").concat(s[t],"; ")}));return'\n      <div contenteditable\n        style="width: '.concat(a,"px; ").concat(p.join(" "),'"\n        data-col="').concat(i,'"\n        data-col-public="').concat(o,'"\n        data-row="').concat(t,'"\n        data-id="').concat(i,":").concat(t,'"\n        data-id-public="').concat(o).concat(t,'"\n        class="data__cell">\n        ').concat(l||"",'\n        <hr class="selection-el" data-selection="true" />\n      </div>\n    ')}}function st(t){var e=t.letter,r=t.index,n=t.width;return'\n    <div\n      style="width: '.concat(n,'px"\n      data-type="resizable"\n      data-maincoll="true" \n      data-col-public="').concat(e,'"\n      data-col="').concat(r,'"\n      class="data__column"\n    >\n      ').concat(e,'\n      <div data-resize="col" class="data__col-resize col-resize"></div>\n    </div>\n  ')}function ft(t){return function(e,r){if(r){var n=function(t,e){return t.resizeState.row[e]||u.fw}(t,r);return'\n        <div\n          style="height:'.concat(n,'px"\n          ').concat(r&&'data-row="'.concat(r,'"'),"\n          ").concat(r&&'data-type="resizable"','\n          class="excel-table__row row"\n        >\n          <div data-mainrow="true" data-row="').concat(r,'" class="row__info">\n            ').concat(r,'\n            <div data-resize="row" class="row__row-resize row-resize"></div>\n          </div>\n          <div class="row__data data">').concat(e,"</div>\n        </div>\n      ")}return'\n        <div class="excel-table__row row">\n          <div class="row__info"></div>\n          <div class="row__data data">'.concat(e,"</div>\n        </div>\n      ")}}function pt(){var t=-1,e=1;return function(){return++t>u.uh&&(e++,t=0),String.fromCharCode(u.aU.A+t).repeat(e)}}function yt(t,e){return t.resizeState.col[e]||u.$7}function bt(t){return function(e,r){return{letter:e,index:++r,width:yt(t,r)}}}function dt(t,e,r){return new Promise((function(n){var o=e.getParent('[data-type="resizable"]');if(o){var i=0,a=o.coords,c=t===u.Nq.ROW?"bottom":"right";o.addClass("".concat(t,"-resizing"));var l=function(){document.onmousemove=null,document.onmouseup=null,o.removeClass("".concat(t,"-resizing"))},s=function(){var t,r,n;e.css((n="-3px",(r=c)in(t={top:"auto",left:"auto"})?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t))};if(t===u.Nq.COL){var f=r.findAll('[data-col="'.concat(o.data.col,'"]'));document.onmousemove=function(t){i=t.pageX-a.right,e.css({left:a.width+i-u.O7+"px"})},document.onmouseup=function(){var t=function(t){o.css({width:t+"px"}),f.forEach((function(e){e.css({width:t+"px"})})),n({type:"col",id:o.data.col||"",value:t})};-i>a.width-u.PA&&i<0?t(u.PA):t(a.width+i),l(),s()}}t===u.Nq.ROW&&(document.onmousemove=function(t){i=t.clientY-a.bottom,e.css({top:a.height+i-u.O7+"px"})},document.onmouseup=function(){var t=function(t){o.css({height:t+"px"}),n({type:"row",id:o.data.row||"",value:t})};-i>a.height-u.ii&&i<0?t(u.ii):t(a.height+i),l(),s()})}}))}function ht(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,c=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}(t,e)||mt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(t){return function(t){if(Array.isArray(t))return Ot(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||mt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(t,e){if(t){if("string"==typeof t)return Ot(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ot(t,e):void 0}}function Ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var wt=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$allCells=e,this.$allHeaders=r}var e,n,o;return e=t,(n=[{key:"clearSelectionClassName",value:function(t,e){return t.forEach((function(t){return t.removeClass(e)})),t}},{key:"findAndSelect",value:function(t,e){var r=this;return t.map((function(t){if("string"==typeof t){if(!(r.$allCells[t]instanceof p))throw new Error('Selection: Cell is not found. Id:"'.concat(t,'" in $allCells'));return r.$allCells[t].addClass(e),r.$allCells[t]}return t.addClass(e),t}))}},{key:"clearSelectGroup",value:function(t){if(!t.length)return[];var e=t[0].find("[data-selection]");return!!e&&(e.removeClass(u.wC),e.css({width:"0px",height:"0px"}),t)}},{key:"selectGroup",value:function(t){var e=function(t){var e=t.length-1,n=t[0].data.id,o=t[e].data.id;if(!n||!o)return{col:0,row:0};var i=function(t,e){return t<e?1:-1},a={col:[],row:[]};[n,o].forEach((function(t){var e=r.d.parseCellId(t);Object.keys(e).forEach((function(t){e[t]&&a[t].push(e[t])}))})),Object.keys(a).forEach((function(t){a[t]=a[t].filter(i)}));var c=Object.keys(a).reduce((function(t,e){var r=ht(a[e],2),n=r[0],o=r[1]-n+1;return t[e]=o,t}),{col:0,row:0}),u=t.reduce((function(t,e){var n,o=e.getStyles(["width"]),i=null===(n=e.getParent('[data-type="resizable"]'))||void 0===n?void 0:n.getStyles(["height"]);if(o&&i){var a=r.d.parseStyleValueToInt(o.width),c=r.d.parseStyleValueToInt(i.height);t.row+=c,t.col+=a}return t}),{col:0,row:0});return Object.keys(u).forEach((function(e){u[e]=u[e]/t.length-1})),Object.keys(u).reduce((function(t,e){return t[e]=u[e]*c[e]+c[e],t}),{col:0,row:0})}(t),n=e.col,o=e.row,i=t[0].find("[data-selection]");return!!i&&(null==i||i.addClass(u.wC),i.css({width:"".concat(n,"px"),height:"".concat(o,"px")}),t)}},{key:"selectHeaders",value:function(t){var e=this,n=[];return t.forEach((function(t){var o=r.d.parseCellId(t);Object.keys(o).forEach((function(t){var r=e.$allHeaders[t][o[t]];r&&(n.push(r),r.addClass(u.un))}))})),n}}])&&_t(e.prototype,n),o&&_t(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Et=function(){function r(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.emitter=t,this.wredux=e}var n,o,i;return n=r,(o=[{key:"emitData",value:function(r){var n=r.data.id,o=r.data.id;if(!n||!o)return!1;this.emitter.emit(t.V.TABLE_EMIT_INFO,o);var i=this.wredux.getState().excelState.parserData;return i[n]?this.wredux.dispatch((0,e.No)(n,i[n].formula)):this.wredux.dispatch((0,e.No)(n,r.textContent)),this.wredux.dispatch((0,e.Wt)(r.getStyles())),r}},{key:"sendFirstRenderCell",value:function(e,r){var n=this.wredux.getState().excelState.parserData;n[e]?this.emitter.emit(t.V.TABLE_CELECT_CELL,n[e].formula):this.emitter.emit(t.V.TABLE_CELECT_CELL,r)}},{key:"sendTextInStore",value:function(t,r){this.wredux.dispatch((0,e.No)(t,r))}},{key:"sendStylesChanged",value:function(t,r){this.wredux.dispatch((0,e.Fd)(t,r))}},{key:"saveCurentExcel",value:function(){var t=this.wredux.getState().excelState;this.wredux.dispatch((0,e.lh)(t))}},{key:"excelState",get:function(){return this.wredux.getState().excelState}}])&&gt(n.prototype,o),i&&gt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),r}();function jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var St=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"changeTypeCell",value:function(t,e){var r=t.textContent,n=Number(r);if(isNaN(n)){if("%"===r[r.length-1]||"р"===r[r.length-1]){var o=r.slice(0,-1);t.setHtml("".concat(o))}}else{var i="";"percent"===e&&(i="%"),"ruble"===e&&(i="р"),t.setHtml("".concat(n," ").concat(i))}}}])&&jt(e.prototype,r),n&&jt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Pt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,c=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ct(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ct(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var xt=function(){function t(e,r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),kt(this,"$activeHeaders",[]),kt(this,"$groupCells",[]),kt(this,"$activeCell",y.create("div")),kt(this,"$formulaSelectCells",[]),this.parser=o,this.$allCells=function(t){var e=t.findAll("[data-id]"),r={};return e.forEach((function(t){var e=t.data.id,n=t.data.idPublic;e&&n&&(r[e]=t,r[n]=t)})),r}(e),this.$allHeaders=function(t){var e=[].concat(vt(t.findAll("[data-maincoll]")),vt(t.findAll("[data-mainrow]"))),r={col:{},row:{}};return e.forEach((function(t){var e=null;t.data.col&&(e="col"),t.data.row&&(e="row"),e&&(r[e][t.data[e]]=t)})),r}(e),this.selector=new wt(this.$allCells,this.$allHeaders),this.dataSender=new Et(r,n),this.typer=new St,this.selectCell(u.z0),this.dataSender.sendFirstRenderCell(u.z0,this.$activeCell.textContent)}var e,n,o;return e=t,(n=[{key:"clearSelectCell",value:function(){this.selector.clearSelectionClassName([this.$activeCell],u.Wb)}},{key:"selectCell",value:function(t){this.clearHeaders(),this.clearGroup(),this.clearSelectCell(),this.clearSelectFormulaCells();var e=Pt(this.selector.findAndSelect([t],u.Wb),1)[0];return e?(e.focus(),this.selectHeaders([e]),this.dataSender.emitData(e),this.$activeCell=e,e):(this.dataSender.saveCurentExcel(),!1)}},{key:"selectGroup",value:function(t){this.clearGroup();var e=this.$allCells[t];if(!e)return!1;var n=this.$activeCell.data.id,o=e.data.id;if(n&&o){for(var i=[n,o].map((function(t){return r.d.parseCellId(t)})),a=Pt(i,2),c=a[0],u=a[1],l=[],s=function(t,e){return t<e?1:-1},f=Pt([c.col,u.col].sort(s),2),p=f[0],y=f[1],b=Pt([c.row,u.row].sort(s),2),d=b[0],h=b[1],v=y;v<=p;v+=1)for(var m=h;m<=d;m+=1){var O=this.$allCells["".concat(v,":").concat(m)];O&&l.push(O)}this.$activeCell.focus();var _=this.selector.selectGroup(l);if(_)return this.$groupCells=_,this.selectHeaders(_),_}return this.dataSender.saveCurentExcel(),!1}},{key:"clearGroup",value:function(){this.selector.clearSelectGroup(this.$groupCells),this.$groupCells=[]}},{key:"selectHeaders",value:function(t){var e=[];t.forEach((function(t){var r=t.data.id;r&&e.push(r)}));var r=this.selector.selectHeaders(e);this.$activeHeaders=r}},{key:"clearHeaders",value:function(){this.selector.clearSelectionClassName(this.$activeHeaders,u.un),this.$activeHeaders=[]}},{key:"selectAllCells",value:function(){var t=Object.values(this.$allCells);this.selectCell(t[0]),this.selector.selectGroup(t),this.$groupCells=t}},{key:"clearSelectFormulaCells",value:function(){this.selector.clearSelectionClassName(this.$formulaSelectCells,u.xT),this.$formulaSelectCells=[]}},{key:"selectFormulaCells",value:function(){var t=this.dataSender.excelState.parserData,e=this.$activeCell.data.id;if(e){var r=t[e];if(r){var n=this.parser.checkCells(r.formula),o=this.selector.findAndSelect(n,u.xT);this.$formulaSelectCells=o}}}},{key:"focusActiveCell",value:function(){this.$activeCell.focus()}},{key:"applyStyle",value:function(t){var e=this;this.$activeCell.css(t),this.$groupCells.forEach((function(r){r.data.id&&(r.css(t),e.dataSender.sendStylesChanged(r.data.id,t))})),this.$activeCell.data.id&&this.dataSender.sendStylesChanged(this.$activeCell.data.id,t),this.$activeCell.focus(),this.dataSender.saveCurentExcel()}},{key:"updateSelectGroup",value:function(){this.$groupCells.length&&this.selector.selectGroup(this.$groupCells)}},{key:"changeText",value:function(t){var e=this.$activeCell.data.id;e&&(this.$activeCell.setTextContent(this.parser.parse(t,"output",e)),this.dataSender.sendTextInStore(e,t),this.dataSender.saveCurentExcel())}},{key:"onInputHandler",value:function(){this.updateAllParserResult();var t=this.$activeCell.textContent,e=this.$activeCell.data.id;e&&(this.dataSender.sendTextInStore(e,this.parser.parse(t,"input",e)),this.dataSender.saveCurentExcel())}},{key:"updateAllParserResult",value:function(){var t=this,e=this.dataSender.excelState.parserData;Object.keys(e).map((function(t){return""!==e[t].formula&&{id:t,formula:e[t].formula}})).filter((function(t){return!1!==t})).forEach((function(e){var r=e.id,n=e.formula,o=t.$allCells[r];o&&o.data.id!==t.$activeCell.data.id&&o.setTextContent(t.parser.parse(n,"output",o.data.id))})),this.clearSelectFormulaCells(),this.selectFormulaCells(),this.dataSender.saveCurentExcel()}},{key:"onKeydownHandler",value:function(t){var e=this.$activeCell.data.id;if(e){var n=t.key,o=t.shiftKey,i=r.d.parseCellId(e);if(u.dP.includes(n)){t.preventDefault();var a=function(t,e,r){var n=e.col,o=e.row;switch(t){case u.nv.ARROW_UP:o--;break;case u.nv.ARROW_DOWN:o++;break;case u.nv.ARROW_LEFT:n--;break;case u.nv.ARROW_RIGHT:n++;break;case u.nv.TAB:r?n--:n++;break;case u.nv.ENTER:r?o--:o++}return{col:n,row:o}}(n,i,o),c=a.col,l=a.row;this.selectCell("".concat(c,":").concat(l))}this.dataSender.saveCurentExcel()}}},{key:"selectFullColumnOrRow",value:function(t,e){var r=[];e&&!t&&(r=Object.values(this.$allCells).filter((function(t){return t.data.row===e}))),t&&!e&&(r=Object.values(this.$allCells).filter((function(e){return e.data.col===t}))),this.selectCell(r[0]);var n=this.selector.selectGroup(r);n&&(this.$groupCells=n),this.dataSender.saveCurentExcel()}},{key:"getText",value:function(t){var e=this.$allCells[t];return!!e&&e.textContent}},{key:"changeType",value:function(t){var e=this,r=t.dataType;"string"==typeof r&&(this.$groupCells.length?this.$groupCells.forEach((function(t){return e.typer.changeTypeCell(t,r)})):(this.typer.changeTypeCell(this.$activeCell,r),this.dataSender.saveCurentExcel()))}}])&&Tt(e.prototype,n),o&&Tt(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Rt(){Rt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var o=e&&e.prototype instanceof f?e:f,i=Object.create(o.prototype),a=new E(n||[]);return i._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return S()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=_(a,r);if(c){if(c===s)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===s)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(t,r,a),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var s={};function f(){}function p(){}function y(){}var b={};c(b,o,(function(){return this}));var d=Object.getPrototypeOf,h=d&&d(d(j([])));h&&h!==e&&r.call(h,o)&&(b=h);var v=y.prototype=f.prototype=Object.create(b);function m(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==At(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function _(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return s;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return s}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,s;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,s):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,s)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function g(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function j(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=y,c(v,"constructor",y),c(y,"constructor",p),p.displayName=c(y,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},m(O.prototype),c(O.prototype,i,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new O(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(v),c(v,a,"Generator"),c(v,o,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=j,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(g),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,s):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),s},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),g(r),s}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;g(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),s}},t}function Lt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Dt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mt(t,e){return Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mt(t,e)}function It(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ht(t);if(e){var o=Ht(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return $t(this,r)}}function $t(t,e){if(e&&("object"===At(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ht(t){return Ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ht(t)}function Wt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Bt,Ut,Ft=function(r){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mt(t,e)}(l,r);var n,o,i,a,c,u=It(l);function l(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),u.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Dt(Object(r),!0).forEach((function(e){Wt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Table",listeners:["mousedown","keydown","input"]},e))}return n=l,o=[{key:"onMousedown",value:function(t){if(t.target instanceof HTMLDivElement){var e=y(t.target),r=e.data.id,n=e.data,o=n.resize,i=n.maincoll,a=n.mainrow,c=n.col,u=n.row;(i||a)&&(t.preventDefault(),this.tableViewApi.selectFullColumnOrRow(c,u)),t.shiftKey&&r?(t.preventDefault(),this.tableViewApi.selectGroup(r)):r&&this.tableViewApi.selectCell(r),o&&this.resizeTable(o,e)}}},{key:"resizeTable",value:(a=Rt().mark((function t(r,n){var o;return Rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt(r,n,this.$root);case 3:o=t.sent,this.dispatch((0,e.VB)(o)),this.tableViewApi.updateSelectGroup(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.warn(t.t0.message);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})),c=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=a.apply(t,e);function i(t){Lt(o,r,n,i,c,"next",t)}function c(t){Lt(o,r,n,i,c,"throw",t)}i(void 0)}))},function(t,e){return c.apply(this,arguments)})},{key:"onKeydown",value:function(t){this.tableViewApi.onKeydownHandler(t)}},{key:"onInput",value:function(){this.tableViewApi.onInputHandler()}},{key:"componentDidMount",value:function(){var e=this,r={on:this.on.bind(this),emit:this.emit.bind(this)},n={dispatch:this.dispatch.bind(this),getState:this.getState.bind(this)};this.tableViewApi=new xt(this.$root,r,n,this.parser),this.on(t.V.FORMULA_INPUT,(function(t){"string"==typeof t&&(e.tableViewApi.changeText(t),e.tableViewApi.updateAllParserResult())})),this.on(t.V.FORMULA_TAB_OR_ENTER_PRESS,(function(){e.tableViewApi.focusActiveCell()})),this.on(t.V.FORMULA_SELECT_ALL,(function(){e.tableViewApi.selectAllCells()})),this.on(t.V.TOOLBAR_BUTTON_CLICK,(function(t){if("object"===At(t)&&"string"==typeof Object.values(t)[0]){"dataType"===Object.keys(t)[0]&&e.tableViewApi.changeType(t);var r=t;e.tableViewApi.applyStyle(r)}}));var o=this.emit.bind(this);this.on(t.V.PARSER_CHECK_CELL,(function(r){if("string"==typeof r){var n=e.tableViewApi.getText(r);if(!1!==n){if(""===n)return void o(t.V.TABLE_PARSER_ID,"".concat(r,"|",0));o(t.V.TABLE_PARSER_ID,"".concat(r,"|").concat(n))}}})),this.on(t.V.PARSER_CLEAR_FORMULA_SELECT,(function(){e.tableViewApi.clearSelectFormulaCells()})),this.on(t.V.FORMULA_PRINT_FORMULA_SELECT,(function(){e.tableViewApi.selectFormulaCells()}))}},{key:"toHTML",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,r=arguments.length>2?arguments[2]:void 0,n=[],o=new Array(e).fill("").map(pt()).map(bt(r)).map(st).join("");n.push(ft(r)(o));for(var i=1;i<=t;i++){var a=new Array(e).fill("").map(pt()).map(bt(r)).map(lt(i,r)).join("");n.push(ft(r)(a,i))}return n.join("")}(30,30,this.getState().excelState)}}],o&&Nt(n.prototype,o),i&&Nt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),l}(M.m);function Vt(t,e){if(e){var r="openColorModal"===Object.keys(e)[0]?"color":"background-color";return'\n    <div data-dropdown="true" class="excel-button__dropdown btn-dropdown">\n      '.concat(function(t,e){return u.DM.map((function(r){return"<div ".concat(t," data-value='{\"").concat(e,'":"').concat(r,'"}\' style="background-color: ').concat(r,';" class="btn-dropdown__color"></div>')})).join("")}(t,r),"\n    </div>\n  ")}}function Gt(t){var e=t.icon,r=t.active,n=t.isWall,o=t.value,i=t.modal,a='data-type="button"',c=o?"data-value='".concat(JSON.stringify(o),"'"):"";return'\n    <div class="excel-toolbar__button excel-button '.concat(r?"active":"",'">\n      <i class="material-icons">\n        ').concat(e,"\n      </i>\n      <div ").concat(c," ").concat(a,' class="excel-button__shild"></div>\n      ').concat(i?Vt(a,o):"","\n    </div>\n\n    ").concat(n?'<div class="excel-toolbar__wall"></div>':"","\n  ")}function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function qt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function zt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(r),!0).forEach((function(e){te(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Kt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Xt(t,e){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xt(t,e)}function Yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Qt(t);if(e){var o=Qt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Zt(this,r)}}function Zt(t,e){if(e&&("object"===Jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Qt(t){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qt(t)}function te(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Wt(Ft,"classNames",["excel__table","excel-table"]);var ee,re,ne=L(u.an)((Ut=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(a,e);var r,n,o,i=Yt(a);function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,t,zt({name:"Toolbar",listeners:["click"],subscribe:{state:"excelState",value:["currentCellStyles"]}},e))}return r=a,(n=[{key:"componentDidMount",value:function(){var t=this;document.onclick=function(e){return t.onClickOutside(e)},this.setComponentState(zt(zt({},u.an),this.getState().excelState.currentCellStyles))}},{key:"componentWilUnmount",value:function(){document.onclick=null}},{key:"wreduxChanged",value:function(t){var e=t.excelState.currentCellStyles;this.setComponentState(zt(zt({},this.getComponentState()),e))}},{key:"onClickOutside",value:function(t){if(t.target instanceof HTMLElement){var e=y(t.target),r=this.getComponentState();(r.openBackgroundColorModal||r.openColorModal)&&(e.data.dropdown||this.setComponentState(zt(zt({},r),{},{openBackgroundColorModal:!1,openColorModal:!1})))}}},{key:"onClick",value:function(e){if(e.target instanceof HTMLDivElement){e.stopPropagation();var r=y(e.target);if(this.onClickOutside(e),r.data.type&&r.data.value){var n=JSON.parse(r.data.value);this.setComponentState(zt(zt({},this.getComponentState()),n)),this.emit(t.V.TOOLBAR_BUTTON_CLICK,n)}}}},{key:"template",get:function(){return t=this.getComponentState(),e=function(t){return[{icon:"undo",isWall:!1,active:!1,value:!1},{icon:"redo",isWall:!1,active:!1,value:!1},{icon:"print",isWall:!1,active:!1,value:!1},{icon:"format_paint",isWall:!0,active:!1,value:!1},{icon:"currency_ruble",isWall:!1,active:"ruble"===t.dataType,value:"ruble"===t.dataType?{dataType:"default"}:{dataType:"ruble"}},{icon:"percent",isWall:!1,active:"percent"===t.dataType,value:"percent"===t.dataType?{dataType:"default"}:{dataType:"percent"}},{icon:"chevron_left",isWall:!1,active:!1,value:!1},{icon:"chevron_right",isWall:!0,active:!1,value:!1},{icon:"format_bold",isWall:!1,active:"bold"===t.fontWeight,value:"bold"===t.fontWeight?{fontWeight:"normal"}:{fontWeight:"bold"}},{icon:"format_italic",isWall:!1,active:"italic"===t.fontStyle,value:"italic"===t.fontStyle?{fontStyle:"normal"}:{fontStyle:"italic"}},{icon:"strikethrough_s",isWall:!1,active:"line-through"===t.textDecoration,value:"line-through"===t.textDecoration?{textDecoration:"none"}:{textDecoration:"line-through"}},{icon:"format_underlined",isWall:!0,active:"underline"===t.textDecoration,value:"underline"===t.textDecoration?{textDecoration:"none"}:{textDecoration:"underline"}},{icon:"format_color_text",isWall:!1,modal:t.openColorModal,active:!0===t.openColorModal,value:!0===t.openColorModal?{openColorModal:!1}:{openColorModal:!0}},{icon:"format_color_fill",isWall:!0,active:!0===t.openBackgroundColorModal,modal:t.openBackgroundColorModal,value:!0===t.openBackgroundColorModal?{openBackgroundColorModal:!1}:{openBackgroundColorModal:!0}},{icon:"border_all",isWall:!1,active:"1px solid black"===t.border,value:"1px solid black"===t.border?{border:"1px solid rgb(222, 222, 222)"}:{border:"1px solid black"}},{icon:"format_align_left",isWall:!1,active:"flex-start"===t.justifyContent,value:{justifyContent:"flex-start"}},{icon:"format_align_center",isWall:!1,active:"center"===t.justifyContent,value:{justifyContent:"center"}},{icon:"format_align_right",isWall:!0,active:"flex-end"===t.justifyContent,value:{justifyContent:"flex-end"}},{icon:"align_vertical_top",isWall:!1,active:"flex-start"===t.alignItems,value:{alignItems:"flex-start"}},{icon:"align_vertical_center",isWall:!1,active:"center"===t.alignItems,value:{alignItems:"center"}},{icon:"align_vertical_bottom",isWall:!1,active:"flex-end"===t.alignItems,value:{alignItems:"flex-end"}}]}(t),e.map(Gt).join("");var t,e}},{key:"toHTML",value:function(){return this.template}}])&&Kt(r.prototype,n),o&&Kt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),a}(M.m),te(Ut,"classNames",["excel__toolbar","excel-toolbar"]),Bt=Ut))||Bt;function oe(t){return'\n    <ul class="db-table__ul">\n      '.concat(function(t){return t.length?t.map((function(t){return'\n        <li class="db-table__li db-li-table">\n          <a href="#excel/'.concat(t.id,'">\n            <div class="db-li-table__content db-li-content">\n              <div class="db-li-content__icon"></div>\n              <div class="db-li-content__title">').concat(t.title,'</div>\n              <div class="db-li-content__data">\n                <div class="date">').concat(new Date(t.openDate).toLocaleDateString(),'</div>\n                <div class="time">').concat(new Date(t.openDate).toLocaleTimeString(),'</div>\n              </div>\n              <div data-delete-id="').concat(t.id,'" class="db-li-content__delete">\n                <i data-delete-id="').concat(t.id,'" data-menu="true" class="material-icons">\n                  delete\n                </i>\n              </div>\n            </div>\n          </a>\n        </li>')})).join(" "):"<h2>Вы не создали не одной таблицы</h2>"}(t),"\n    </ul>\n  ")}function ie(t){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(t)}function ae(t){return function(t){if(Array.isArray(t))return ce(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ce(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ce(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ue(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function se(t,e){return se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},se(t,e)}function fe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ye(t);if(e){var o=ye(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return pe(this,r)}}function pe(t,e){if(e&&("object"===ie(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ye(t){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ye(t)}function be(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var de=L({excels:[]})((re=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&se(t,e)}(a,t);var r,n,o,i=fe(a);function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(r),!0).forEach((function(e){be(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"TableList",listeners:["click"],subscribe:{state:"dashboardState",value:["excels"]}},e))}return r=a,(n=[{key:"componentDidMount",value:function(){var t=this.getState().dashboardState.excels;this.setComponentState({excels:ae(t)})}},{key:"wreduxChanged",value:function(t){var e=t.dashboardState.excels;this.setComponentState({excels:ae(e)})}},{key:"onClick",value:function(t){if(t.target instanceof HTMLElement){var r=y(t.target).data.deleteId;if(r){t.preventDefault();var n=this.getComponentState().excels.find((function(t){return t.id===+r}));window.confirm("Вы действительно хотите удалить: ".concat(null==n?void 0:n.title))&&this.dispatch((0,e.N)(Number(r)))}}}},{key:"toHTML",value:function(){return function(t){return'\n    <div class="db-list__board db-li-board">\n      <div class="db-li-board__table db-table">\n        '.concat(oe(t),"\n      </div>\n    </div>\n  ")}(this.getComponentState().excels)}}])&&le(r.prototype,n),o&&le(r,o),Object.defineProperty(r,"prototype",{writable:!1}),a}(w.w),be(re,"classNames",["db__list","db-list"]),ee=re))||ee,he=__webpack_require__(879);function ve(t){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(t)}function me(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _e(t,e){return _e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_e(t,e)}function we(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ee(t);if(e){var o=Ee(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ge(this,r)}}function ge(t,e){if(e&&("object"===ve(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ee(t){return Ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ee(t)}function je(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Se,Pe,Ce=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_e(t,e)}(i,t);var e,r,n,o=we(i);function i(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?me(Object(r),!0).forEach((function(e){je(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"TableCreator",listeners:["click"]},e))}return e=i,(r=[{key:"onClick",value:function(t){if(t.target instanceof HTMLElement){var e=y(t.target),r=Date.now().toString();e.data.createTable&&(d.navigation("#excel/".concat(r)),this.dispatch((0,he.z)(Number(r)))),e.data.createIvest&&(d.navigation("#excel/".concat(r)),this.dispatch((0,he.i2)(Number(r),u.tA)))}}},{key:"toHTML",value:function(){return'\n    <div class="db-create__board db-cr-board">\n      <h2 class="db-cr-board__title">Создать таблицу</h2>\n      <a data-create-table="true" class="db-cr-board__link table-link">\n        <div data-create-table="true" class="table-link__square"></div>\n        <div data-create-table="true" class="table-link__text"><span>Пустой файл</span></div>\n      </a>\n      <a data-create-ivest="true" class="db-cr-board__link table-link">\n        <div data-create-ivest="true" class="table-link__square"></div>\n        <div data-create-ivest="true" class="table-link__text"><span>Трекер инвестиций</span></div>\n      </a>\n    </div>\n  '}}])&&Oe(e.prototype,r),n&&Oe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(w.w);function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function ke(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function xe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ke(Object(r),!0).forEach((function(e){Me(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ke(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Re(t,e){return Re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Re(t,e)}function Le(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ne(t);if(e){var o=Ne(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return De(this,r)}}function De(t,e){if(e&&("object"===Te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ne(t){return Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ne(t)}function Me(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}je(Ce,"classNames",["db__create","db-create"]);var Ie=L({openMenu:!1,openServices:!1})((Pe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Re(t,e)}(i,t);var e,r,n,o=Le(i);function i(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,xe({name:"DashHeader",listeners:["click"]},e))}return e=i,(r=[{key:"componentDidMount",value:function(){var t=this;document.onclick=function(e){return t.onClickOutside(e)}}},{key:"componentWilUnmount",value:function(){document.onclick=null}},{key:"onClick",value:function(t){if(t.target instanceof HTMLElement){var e=y(t.target),r=xe({},this.getComponentState());e.data.menu&&(r.openMenu=!r.openMenu,this.setComponentState(r)),e.data.services&&(r.openServices=!r.openServices,this.setComponentState(r))}}},{key:"onClickOutside",value:function(t){if(t.target instanceof HTMLElement){var e=y(t.target);e.data.modal||e.data.menu||e.data.services||this.setComponentState(xe(xe({},this.getComponentState()),{},{openMenu:!1,openServices:!1}))}}},{key:"toHTML",value:function(){return t=this.getComponentState(),"\n   ".concat((e=t.openMenu,'\n   <div class="db-header__menu db-menu">\n      <button data-menu="true" class="db-menu__burger-menu">\n        <i data-menu="true" class="material-icons">\n          menu\n        </i>\n      </button>\n      <div class="db-menu__logo db-logo">\n        <div class="db-logo__img"></div>\n        <div class="db-logo__text"><h1>TypeScript Таблицы</h1></div>\n      </div>\n    </div>\n    '.concat(e?'\n    <div data-modal="true" class="db-header a-menu">\n      <div data-modal="true" class="icon">\n        <i data-modal="true" class="material-icons">mood_bad</i>\n        <h4 data-modal="true">Уупс... приложения в разработке</h4>\n      </div>\n    </div>\n  ':"","\n  ")),"\n   ").concat(function(t){return'\n    <div class="db-header__user db-user">\n      <button data-services="true" class="db-user__apps">\n        <i data-services="true" class="material-icons">\n          apps\n        </i>\n      </button>\n      <div class="db-user__user">\n        <i class="material-icons">\n          account_circle\n        </i>\n      </div>\n      '.concat(t?'\n    <div data-modal="true" data-modal="true" class="db-user db-dropdown">\n      <div data-modal="true" class="icon">\n        <i data-modal="true" class="material-icons">mood_bad</i>\n        <h4 data-modal="true">Уупс... тут были наши сервисы</h4>\n      </div>\n    </div>\n  ':"","\n    </div>\n  ")}(t.openServices),"\n  ");var t,e}}])&&Ae(e.prototype,r),n&&Ae(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(w.w),Me(Pe,"classNames",["db__header","db-header"]),Se=Pe))||Se;function $e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var He=function(){function t(e){var r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o=[],(n="instantComponents")in(r=this)?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,this.components=e.components,this.wredux=e.wredux,this.wreduxSubscriber=e.wreduxSubscriber,this.emitter=e.emitter}var e,r,n;return e=t,r=[{key:"getRootDashboard",value:function(){var t=y.create("div","db"),e={emitter:this.emitter,wredux:this.wredux};return this.instantComponents=this.components.map((function(r){var n=y.create("div",r.classNames),o=new r(n,e);return n.setHtml(o.toHTML()),t.append(n),o})),t}},{key:"init",value:function(){this.wreduxSubscriber.subscribeComponents(this.instantComponents),this.instantComponents.forEach((function(t){t.init(),t.componentDidMount()}))}},{key:"destroy",value:function(){this.instantComponents.forEach((function(t){t.componentWilUnmount(),t.destroy()})),this.wreduxSubscriber.unsubscribeComponents()}}],r&&$e(e.prototype,r),n&&$e(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function Be(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ue(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ge(t,e){return Ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ge(t,e)}function Je(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ze(t);if(e){var o=ze(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return qe(this,r)}}function qe(t,e){if(e&&("object"===We(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ze(t){return ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ze(t)}var Ke=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ge(t,e)}(i,t);var e,r,n,o=Je(i);function i(){return Fe(this,i),o.apply(this,arguments)}return e=i,r=[{key:"getRoot",value:function(){var t;return this.dashbpard=new He(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Be(Object(r),!0).forEach((function(e){Ue(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Be(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({components:[Ie,Ce,de]},this.options)),null===(t=this.dashbpard)||void 0===t?void 0:t.getRootDashboard()}},{key:"initPage",value:function(){var t;null===(t=this.dashbpard)||void 0===t||t.init()}},{key:"destroyPage",value:function(){var t;null===(t=this.dashbpard)||void 0===t||t.destroy()}}],r&&Ve(e.prototype,r),n&&Ve(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(_);function Xe(t){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xe(t)}function Ye(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ze(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function tr(t,e){return tr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tr(t,e)}function er(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=nr(t);if(e){var o=nr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return rr(this,r)}}function rr(t,e){if(e&&("object"===Xe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function nr(t){return nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nr(t)}var or=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tr(t,e)}(i,t);var e,r,n,o=er(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).firstparam=d.firstParam,e}return e=i,r=[{key:"getRoot",value:function(){return this.excel=new $(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ye(Object(r),!0).forEach((function(e){Ze(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({components:[it,ne,X,Ft]},this.options)),this.excel.getRootExcel()}},{key:"initPage",value:function(){var t;null===(t=this.excel)||void 0===t||t.init()}},{key:"destroyPage",value:function(){var t;null===(t=this.excel)||void 0===t||t.destroy()}}],r&&Qe(e.prototype,r),n&&Qe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(_);new N("#root",[{path:"/",Page:Ke},{path:"dashboard",Page:Ke},{path:"excel",Page:or}]).render()}()})();